import tkinter as tk
import json

# Initialize the main window
root = tk.Tk()
root.title("Expense Tracker")

# Global variable for total expenses
total_expenses = 0
category_totals = {}

# Create Textbox
def create_textbox(height, width):
    textbox = tk.Text(root, height=height, width=width, state="normal")
    textbox.grid(row=0, column=0, columnspan=2)
    return textbox

textbox = create_textbox(10, 30)
textbox.config(borderwidth=1, relief="sunken")

# Create Scrollbar and attach it to the Text widget
scrollbar = tk.Scrollbar(root, command=textbox.yview)
scrollbar.grid(row=0, column=2, sticky="ns")
textbox.config(yscrollcommand=scrollbar.set)

# Budget entry
budget_entry = tk.Entry(root)
budget_entry.grid(row=1, column=0)

def submit_budget():
    global budget
    try:
        budget = float(budget_entry.get())
        textbox.insert(tk.END, f"Budget set to: {budget}\n")
        budget_entry.delete(0, tk.END)
    except ValueError:
        textbox.insert(tk.END, "Invalid input for budget. Please enter a number.\n")

submit_button = tk.Button(text="Submit Budget", command=submit_budget)
submit_button.grid(row=1, column=1)

# Function to enter expenses
def enter_expense():
    global total_expenses, category_totals
    try:
        amount = float(expense_entry.get())
        title = title_entry.get()
        category = category_entry.get()

        # Update totals
        total_expenses += amount
        remaining_budget = budget - total_expenses

        # Update category totals
        if category not in category_totals:
            category_totals[category] = 0
        category_totals[category] += amount

        # Display information
        textbox.insert(tk.END, f"Expense Added: {title} - ${amount} in {category}\n")
        textbox.insert(tk.END, f"Remaining Budget: ${remaining_budget}\n")

        # Clear input fields
        expense_entry.delete(0, tk.END)
        title_entry.delete(0, tk.END)
        category_entry.delete(0, tk.END)
    except ValueError:
        textbox.insert(tk.END, "Invalid input for expense amount. Please enter a number.\n")

# Input fields for expense entry
title_entry = tk.Entry(root)
title_entry.grid(row=2, column=0)
title_entry.insert(0, "Title")

expense_entry = tk.Entry(root)
expense_entry.grid(row=3, column=0)
expense_entry.insert(0, "Amount")

category_entry = tk.Entry(root)
category_entry.grid(row=4, column=0)
category_entry.insert(0, "Category")

add_expense_button = tk.Button(root, text="Add Expense", command=enter_expense)
add_expense_button.grid(row=5, column=0)

# Function to save expenses to a JSON file
def save_expenses():
    expenses = {"total_expenses": total_expenses, "category_totals": category_totals}
    with open("expenses.json", "w") as f:
        json.dump(expenses, f)
    textbox.insert(tk.END, "Expenses saved to expenses.json\n")

save_button = tk.Button(root, text="Save Expenses", command=save_expenses)
save_button.grid(row=6, column=0)

# Lock and Unlock Textbox Functions
def lock_textbox():
    textbox.config(state="disabled")

def unlock_textbox():
    textbox.config(state="normal")

lock_button = tk.Button(root, text="Lock Textbox", command=lock_textbox)
lock_button.grid(row=7, column=0)

unlock_button = tk.Button(root, text="Unlock Textbox", command=unlock_textbox)
unlock_button.grid(row=7, column=1)

# Run the Tkinter main loop
root.mainloop()
